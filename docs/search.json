[
  {
    "objectID": "eda.html",
    "href": "eda.html",
    "title": "Project 2 EDA",
    "section": "",
    "text": "Preprocessing\n\nsuppressPackageStartupMessages(library(tidyverse))\nlibrary(RKaggle)\nlibrary(ggthemes)\nlibrary(ggpointdensity)\nlibrary(knitr)\n\n\n\nRead in and Process Data\n\nraw_df &lt;- RKaggle::get_dataset(\"valakhorasani/mobile-device-usage-and-user-behavior-dataset\") \n\nRows: 700 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): Device Model, Operating System, Gender\ndbl (8): User ID, App Usage Time (min/day), Screen On Time (hours/day), Batt...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndf &lt;- raw_df |&gt; as_tibble() |&gt;\n    rename(\"ID\" = \"User ID\", \"Device\" = \"Device Model\", \"OS\" = \"Operating System\",\n             \"AppUsage\" = \"App Usage Time (min/day)\", \"ScreenTime\" = \"Screen On Time (hours/day)\",\n             \"BatteryDrain\" = \"Battery Drain (mAh/day)\", \"NumApps\" = \"Number of Apps Installed\",\n             \"DataUsage\" = \"Data Usage (MB/day)\", \"UserClass\" = \"User Behavior Class\") |&gt;\n    mutate(ScreenTime = ScreenTime*60, UserClass = factor(UserClass))\n\n\n\nContingency Tables\n\noptions(dplyr.summarise.inform = FALSE)\ndf |&gt; group_by(UserClass) |&gt; summarize(count = n()) |&gt; \n    pivot_wider(names_from = UserClass, values_from = count) |&gt; kable()\n\n\n\n\n1\n2\n3\n4\n5\n\n\n\n\n136\n146\n143\n139\n136\n\n\n\n\ndf |&gt; group_by(UserClass, Device) |&gt; summarize(count = n()) |&gt;\n    pivot_wider(names_from = UserClass, values_from = count) |&gt; kable()\n\n\n\n\nDevice\n1\n2\n3\n4\n5\n\n\n\n\nGoogle Pixel 5\n32\n26\n33\n24\n27\n\n\nOnePlus 9\n25\n31\n25\n26\n26\n\n\nSamsung Galaxy S21\n26\n30\n21\n33\n23\n\n\nXiaomi Mi 11\n31\n27\n32\n27\n29\n\n\niPhone 12\n22\n32\n32\n29\n31\n\n\n\n\ndf |&gt; group_by(UserClass, Gender) |&gt; summarize(count = n()) |&gt;\n    pivot_wider(names_from = UserClass, values_from = count) |&gt; kable()\n\n\n\n\nGender\n1\n2\n3\n4\n5\n\n\n\n\nFemale\n63\n64\n82\n67\n60\n\n\nMale\n73\n82\n61\n72\n76\n\n\n\n\ndf |&gt; group_by(Device, Gender) |&gt; summarize(count = n()) |&gt;\n    pivot_wider(names_from = Device, values_from = count) |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\nGender\nGoogle Pixel 5\nOnePlus 9\nSamsung Galaxy S21\nXiaomi Mi 11\niPhone 12\n\n\n\n\nFemale\n69\n61\n54\n78\n74\n\n\nMale\n73\n72\n79\n68\n72\n\n\n\n\n\n\n\nNumerical Summaries\n\nsummarize_numeric &lt;- function(df, group, num_var) {\n    return(\n    df |&gt; group_by({{group}}) |&gt; summarize(\"count\" = n(), across(all_of(num_var), \n        list(\"mean\" = mean, \"sd\" = sd, \"IQR\" = ~ quantile(., 0.75) - quantile(., 0.25),\n             \"range\" = ~ max(.) - min(.) , \"min\" = min,\n             \"Q1\" = ~ quantile(., 0.25), \"median\" = median, \"Q3\" = ~ quantile(., 0.25),\n             \"max\" = max), .names = \"{.col}_{.fn}\")) |&gt; kable()\n    )\n}\n\nmap(df |&gt; select(!all_of(c(\"ID\", \"UserClass\")) & where(is.numeric)) |&gt; colnames(),\n    \\(x) summarize_numeric(df, Device, x))\n\n[[1]]\n\n\n|Device             | count| AppUsage_mean| AppUsage_sd| AppUsage_IQR| AppUsage_range| AppUsage_min| AppUsage_Q1| AppUsage_median| AppUsage_Q3| AppUsage_max|\n|:------------------|-----:|-------------:|-----------:|------------:|--------------:|------------:|-----------:|---------------:|-----------:|------------:|\n|Google Pixel 5     |   142|      267.7887|    180.0313|       344.50|            561|           34|       99.00|           231.5|       99.00|          595|\n|OnePlus 9          |   133|      270.3835|    183.4941|       328.00|            568|           30|      105.00|           216.0|      105.00|          598|\n|Samsung Galaxy S21 |   133|      266.4211|    175.2646|       303.00|            563|           30|      111.00|           217.0|      111.00|          593|\n|Xiaomi Mi 11       |   146|      268.4521|    179.7659|       333.75|            566|           31|      102.00|           217.0|      102.00|          597|\n|iPhone 12          |   146|      282.0205|    169.5924|       289.50|            565|           32|      142.25|           257.5|      142.25|          597|\n\n[[2]]\n\n\n|Device             | count| ScreenTime_mean| ScreenTime_sd| ScreenTime_IQR| ScreenTime_range| ScreenTime_min| ScreenTime_Q1| ScreenTime_median| ScreenTime_Q3| ScreenTime_max|\n|:------------------|-----:|---------------:|-------------:|--------------:|----------------:|--------------:|-------------:|-----------------:|-------------:|--------------:|\n|Google Pixel 5     |   142|        304.5634|      185.8372|          288.0|              642|             66|         121.5|               285|         121.5|            708|\n|OnePlus 9          |   133|        314.4812|      185.0741|          288.0|              654|             66|         150.0|               282|         150.0|            720|\n|Samsung Galaxy S21 |   133|        319.0827|      184.7655|          270.0|              648|             60|         168.0|               300|         168.0|            708|\n|Xiaomi Mi 11       |   146|        317.5890|      188.8851|          298.5|              648|             66|         145.5|               294|         145.5|            714|\n|iPhone 12          |   146|        325.8493|      177.9198|          276.0|              654|             60|         174.0|               303|         174.0|            714|\n\n[[3]]\n\n\n|Device             | count| BatteryDrain_mean| BatteryDrain_sd| BatteryDrain_IQR| BatteryDrain_range| BatteryDrain_min| BatteryDrain_Q1| BatteryDrain_median| BatteryDrain_Q3| BatteryDrain_max|\n|:------------------|-----:|-----------------:|---------------:|----------------:|------------------:|----------------:|---------------:|-------------------:|---------------:|----------------:|\n|Google Pixel 5     |   142|          1475.676|        809.3540|          1457.00|               2666|              302|             651|              1443.0|             651|             2968|\n|OnePlus 9          |   133|          1523.850|        835.1512|          1559.00|               2647|              309|             718|              1526.0|             718|             2956|\n|Samsung Galaxy S21 |   133|          1504.571|        820.7009|          1488.00|               2610|              310|             681|              1507.0|             681|             2920|\n|Xiaomi Mi 11       |   146|          1528.877|        821.4425|          1464.50|               2690|              303|             764|              1565.5|             764|             2993|\n|iPhone 12          |   146|          1589.514|        817.1760|          1452.75|               2663|              308|             826|              1538.5|             826|             2971|\n\n[[4]]\n\n\n|Device             | count| NumApps_mean| NumApps_sd| NumApps_IQR| NumApps_range| NumApps_min| NumApps_Q1| NumApps_median| NumApps_Q3| NumApps_max|\n|:------------------|-----:|------------:|----------:|-----------:|-------------:|-----------:|----------:|--------------:|----------:|-----------:|\n|Google Pixel 5     |   142|     49.90845|   27.10079|        43.0|            89|          10|      26.75|             48|      26.75|          99|\n|OnePlus 9          |   133|     49.96992|   26.72190|        46.0|            89|          10|      28.00|             46|      28.00|          99|\n|Samsung Galaxy S21 |   133|     50.80451|   26.92089|        50.0|            89|          10|      25.00|             51|      25.00|          99|\n|Xiaomi Mi 11       |   146|     49.92466|   27.20119|        51.0|            88|          10|      23.75|             49|      23.75|          98|\n|iPhone 12          |   146|     52.72603|   27.01482|        48.5|            89|          10|      28.25|             52|      28.25|          99|\n\n[[5]]\n\n\n|Device             | count| DataUsage_mean| DataUsage_sd| DataUsage_IQR| DataUsage_range| DataUsage_min| DataUsage_Q1| DataUsage_median| DataUsage_Q3| DataUsage_max|\n|:------------------|-----:|--------------:|------------:|-------------:|---------------:|-------------:|------------:|----------------:|------------:|-------------:|\n|Google Pixel 5     |   142|       897.7042|     643.8852|        932.50|            2376|           105|        342.5|            791.0|        342.5|          2481|\n|OnePlus 9          |   133|       911.1203|     621.4013|        988.00|            2374|           103|        371.0|            828.0|        371.0|          2477|\n|Samsung Galaxy S21 |   133|       931.8722|     645.7942|        980.00|            2372|           109|        392.0|            861.0|        392.0|          2481|\n|Xiaomi Mi 11       |   146|       940.1644|     670.8048|        999.25|            2395|           102|        351.0|            820.5|        351.0|          2497|\n|iPhone 12          |   146|       965.5068|     624.7464|        956.75|            2305|           111|        424.5|            907.0|        424.5|          2416|\n\n[[6]]\n\n\n|Device             | count| Age_mean|   Age_sd| Age_IQR| Age_range| Age_min| Age_Q1| Age_median| Age_Q3| Age_max|\n|:------------------|-----:|--------:|--------:|-------:|---------:|-------:|------:|----------:|------:|-------:|\n|Google Pixel 5     |   142| 37.76761| 12.07287|   22.00|        41|      18|     27|         36|     27|      59|\n|OnePlus 9          |   133| 38.87970| 11.58371|   20.00|        40|      19|     29|         40|     29|      59|\n|Samsung Galaxy S21 |   133| 39.11278| 12.38869|   23.00|        41|      18|     28|         39|     28|      59|\n|Xiaomi Mi 11       |   146| 37.76712| 11.65365|   20.75|        41|      18|     28|         37|     28|      59|\n|iPhone 12          |   146| 38.95890| 12.43015|   22.00|        41|      18|     29|         39|     29|      59|\n\nmap(df |&gt; select(!all_of(c(\"ID\", \"UserClass\")) & where(is.numeric)) |&gt; colnames(),\n    \\(x) summarize_numeric(df, UserClass, x))\n\n[[1]]\n\n\n|UserClass | count| AppUsage_mean| AppUsage_sd| AppUsage_IQR| AppUsage_range| AppUsage_min| AppUsage_Q1| AppUsage_median| AppUsage_Q3| AppUsage_max|\n|:---------|-----:|-------------:|-----------:|------------:|--------------:|------------:|-----------:|---------------:|-----------:|------------:|\n|1         |   136|      60.42647|    17.24706|        29.00|             59|           30|       46.00|            64.0|       46.00|           89|\n|2         |   146|     131.97260|    25.46856|        44.25|             88|           91|      107.75|           131.5|      107.75|          179|\n|3         |   143|     235.39860|    34.05963|        58.00|            118|          181|      206.50|           229.0|      206.50|          299|\n|4         |   139|     395.74820|    52.23832|        95.00|            177|          301|      347.50|           405.0|      347.50|          478|\n|5         |   136|     541.41912|    31.13711|        50.25|            117|          481|      516.00|           540.0|      516.00|          598|\n\n[[2]]\n\n\n|UserClass | count| ScreenTime_mean| ScreenTime_sd| ScreenTime_IQR| ScreenTime_range| ScreenTime_min| ScreenTime_Q1| ScreenTime_median| ScreenTime_Q3| ScreenTime_max|\n|:---------|-----:|---------------:|-------------:|--------------:|----------------:|--------------:|-------------:|-----------------:|-------------:|--------------:|\n|1         |   136|        89.42647|      16.84247|           25.5|               60|             60|          76.5|                90|          76.5|            120|\n|2         |   146|       182.26027|      35.86278|           64.5|              120|            120|         150.0|               186|         150.0|            240|\n|3         |   143|       297.35664|      35.47235|           54.0|              120|            240|         270.0|               294|         270.0|            360|\n|4         |   139|       414.56115|      34.62514|           60.0|              114|            360|         384.0|               414|         384.0|            474|\n|5         |   136|       606.88235|      68.08438|          115.5|              234|            486|         550.5|               618|         550.5|            720|\n\n[[3]]\n\n\n|UserClass | count| BatteryDrain_mean| BatteryDrain_sd| BatteryDrain_IQR| BatteryDrain_range| BatteryDrain_min| BatteryDrain_Q1| BatteryDrain_median| BatteryDrain_Q3| BatteryDrain_max|\n|:---------|-----:|-----------------:|---------------:|----------------:|------------------:|----------------:|---------------:|-------------------:|---------------:|----------------:|\n|1         |   136|          454.9779|        89.21447|           162.25|                292|              302|           375.0|               456.0|           375.0|              594|\n|2         |   146|          883.8082|       186.56567|           324.00|                596|              602|           716.5|               894.5|           716.5|             1198|\n|3         |   143|         1515.0559|       167.32387|           292.00|                581|             1210|          1369.0|              1512.0|          1369.0|             1791|\n|4         |   139|         2105.8058|       169.51093|           281.50|                596|             1802|          1974.5|              2102.0|          1974.5|             2398|\n|5         |   136|         2701.0147|       176.91278|           311.75|                590|             2403|          2545.5|              2717.5|          2545.5|             2993|\n\n[[4]]\n\n\n|UserClass | count| NumApps_mean| NumApps_sd| NumApps_IQR| NumApps_range| NumApps_min| NumApps_Q1| NumApps_median| NumApps_Q3| NumApps_max|\n|:---------|-----:|------------:|----------:|-----------:|-------------:|-----------:|----------:|--------------:|----------:|-----------:|\n|1         |   136|     14.55882|   2.900229|           5|             9|          10|         12|           15.0|         12|          19|\n|2         |   146|     30.75342|   5.644114|          10|            18|          21|         26|           31.5|         26|          39|\n|3         |   143|     50.00000|   5.505439|          10|            18|          41|         45|           49.0|         45|          59|\n|4         |   139|     69.92086|   5.420125|           9|            18|          61|         66|           69.0|         66|          79|\n|5         |   136|     89.25000|   5.483646|           9|            18|          81|         84|           89.0|         84|          99|\n\n[[5]]\n\n\n|UserClass | count| DataUsage_mean| DataUsage_sd| DataUsage_IQR| DataUsage_range| DataUsage_min| DataUsage_Q1| DataUsage_median| DataUsage_Q3| DataUsage_max|\n|:---------|-----:|--------------:|------------:|-------------:|---------------:|-------------:|------------:|----------------:|------------:|-------------:|\n|1         |   136|       202.3235|     61.41913|        116.50|             197|           102|       146.00|              202|       146.00|           299|\n|2         |   146|       451.4178|     90.60051|        163.25|             298|           301|       370.25|              450|       370.25|           599|\n|3         |   143|       822.0140|    114.22112|        195.00|             389|           608|       720.50|              828|       720.50|           997|\n|4         |   139|      1232.2302|    146.19227|        263.50|             497|          1002|      1096.00|             1209|      1096.00|          1499|\n|5         |   136|      1974.7721|    297.45511|        477.50|             989|          1508|      1715.00|             1935|      1715.00|          2497|\n\n[[6]]\n\n\n|UserClass | count| Age_mean|   Age_sd| Age_IQR| Age_range| Age_min| Age_Q1| Age_median| Age_Q3| Age_max|\n|:---------|-----:|--------:|--------:|-------:|---------:|-------:|------:|----------:|------:|-------:|\n|1         |   136| 38.21324| 11.28382|    17.0|        41|      18|   29.0|         37|   29.0|      59|\n|2         |   146| 38.64384| 11.59592|    21.0|        41|      18|   28.0|         39|   28.0|      59|\n|3         |   143| 38.67832| 12.80383|    23.5|        41|      18|   27.0|         38|   27.0|      59|\n|4         |   139| 38.67626| 12.65210|    24.5|        41|      18|   25.5|         40|   25.5|      59|\n|5         |   136| 38.17647| 11.79446|    21.0|        41|      18|   28.0|         37|   28.0|      59|\n\n\n\n\nCorrelation Matrix\n\ndf |&gt; select(where(is.numeric) & !c(\"ID\")) |&gt; cor() |&gt; kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAppUsage\nScreenTime\nBatteryDrain\nNumApps\nDataUsage\nAge\n\n\n\n\nAppUsage\n1.0000000\n0.9503330\n0.9563850\n0.9552528\n0.9423075\n0.0043822\n\n\nScreenTime\n0.9503330\n1.0000000\n0.9489831\n0.9469751\n0.9413220\n0.0172322\n\n\nBatteryDrain\n0.9563850\n0.9489831\n1.0000000\n0.9618533\n0.9322758\n-0.0027224\n\n\nNumApps\n0.9552528\n0.9469751\n0.9618533\n1.0000000\n0.9348000\n0.0040340\n\n\nDataUsage\n0.9423075\n0.9413220\n0.9322758\n0.9348000\n1.0000000\n0.0039989\n\n\nAge\n0.0043822\n0.0172322\n-0.0027224\n0.0040340\n0.0039989\n1.0000000\n\n\n\n\n\n\n\nScatter Plots\n\ndf |&gt; ggplot(aes(x = AppUsage, y = ScreenTime, color = UserClass)) + geom_point() +\n    labs(x = \"App Usage (minutes/day)\", y = \"Screen Time (minutes/day)\",\n         color = \"User Behavior Class\", title = \"Screen Time vs App Usage by User Behavior Class\") \n\n\n\n\n\n\n\ndf |&gt; ggplot(aes(x = BatteryDrain, y = NumApps, color = Device)) + geom_point() +\n    labs(x = \"Battery Drain (mAh/day)\", y = \"Number of Apps Installed\", color = \"Device Model\",\n         title = \"Battery Drain vs Number of Apps by Device Model\") \n\n\n\n\n\n\n\n\n\n\nBoxplots\n\ndf |&gt; ggplot(aes(x = UserClass, y = Age)) + geom_boxplot() + facet_grid( ~ Gender) +\n    labs(x = \"User Behavior Class\", y = \"Age (years)\",\n         title = \"Distriubtion of Age By User Class and Gender\")\n\n\n\n\n\n\n\ndf |&gt; ggplot(aes(x = Device, y = Age)) + geom_boxplot() + facet_grid( ~ Gender) +\n    labs(x = \"Device Model\", y = \"Age (years)\",\n         title = \"Distriubtion of Age By Device Model and Gender\") +\n    scale_x_discrete(labels = scales::wrap_format(12))\n\n\n\n\n\n\n\nboxplot_numeric &lt;- function(df, group, num_var) {\n    return(\n    df |&gt; ggplot(aes(x = get(group), y = get(num_var))) + geom_boxplot() +\n        labs(x = group, y = num_var, title = paste(\"Distribution of \", num_var, \" by \", group))\n    )\n}\n\nmap(df |&gt; select(-c(\"ID\") & where(is.numeric)) |&gt; colnames(),\n    \\(x) boxplot_numeric(df, \"Device\", x))\n\n[[1]]\n\n\n\n\n\n\n\n\n\n\n[[2]]\n\n\n\n\n\n\n\n\n\n\n[[3]]\n\n\n\n\n\n\n\n\n\n\n[[4]]\n\n\n\n\n\n\n\n\n\n\n[[5]]\n\n\n\n\n\n\n\n\n\n\n[[6]]\n\n\n\n\n\n\n\n\nmap(df |&gt; select(-c(\"ID\") & where(is.numeric)) |&gt; colnames(),\n    \\(x) boxplot_numeric(df, \"UserClass\", x))\n\n[[1]]\n\n\n\n\n\n\n\n\n\n\n[[2]]\n\n\n\n\n\n\n\n\n\n\n[[3]]\n\n\n\n\n\n\n\n\n\n\n[[4]]\n\n\n\n\n\n\n\n\n\n\n[[5]]\n\n\n\n\n\n\n\n\n\n\n[[6]]\n\n\n\n\n\n\n\n\n\n\n\nDensity Scatter Plots\n\ndf |&gt; ggplot(aes(x = Age, y = ScreenTime, fill = UserClass)) + ggdensity::geom_hdr() +\n    geom_point(shape = 21) + labs(x = \"Age (years)\", y = \"Screen Time (minutes/day)\",\n                                  title = \"Probabilty Density of Age vs Screentime by User Class\")\n\n\n\n\n\n\n\ndf |&gt; ggplot(aes(x = Age, y = ScreenTime, fill = Device)) + ggdensity::geom_hdr() +\n    geom_point(shape = 21) + labs(x = \"Age (years)\", y = \"Screen Time (minutes/day)\",\n                                 title = \"Probabilty Density of Age vs Screentime by Device Model\")\n\n\n\n\n\n\n\ndf |&gt; ggplot(aes(x = Age, y = ScreenTime, fill = Device)) + ggdensity::geom_hdr() +\n    geom_point(shape = 21) + facet_wrap(~ OS, nrow = 2) + \n    labs(x = \"Age (years)\",y = \"Screen Time (minutes/day)\",\n    title = \"Probabilty Density of Age vs Screentime by Device and Operating System\")"
  }
]